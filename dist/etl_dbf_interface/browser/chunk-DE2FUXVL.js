import{a as c}from"./chunk-P75U6W4R.js";import{g as n,l as s,n as a,oa as u,p as i,ta as l}from"./chunk-LRQEKKHY.js";var g=class o{constructor(t,e){this.http=t;this.router=e}currentUserSubject=new n(this.getUserFromStorage());currentUser$=this.currentUserSubject.asObservable();TOKEN_KEY="auth_token";USER_KEY="auth_user";login(t,e){let p=`${c.apiUrl}/api/auth/login`,m={username:t,password:e};return this.http.post(p,m).pipe(s(r=>{r.success&&r.token&&this.setSession(r.token,r.user)}))}logout(){localStorage.removeItem(this.TOKEN_KEY),localStorage.removeItem(this.USER_KEY),this.currentUserSubject.next(null),this.router.navigate(["/login"])}isLoggedIn(){return!!this.getToken()}getToken(){return localStorage.getItem(this.TOKEN_KEY)}getCurrentUser(){return this.currentUserSubject.value}isAdministrator(){return this.getCurrentUser()?.role==="administrator"}setSession(t,e){localStorage.setItem(this.TOKEN_KEY,t),e&&(localStorage.setItem(this.USER_KEY,JSON.stringify(e)),this.currentUserSubject.next(e))}getUserFromStorage(){let t=localStorage.getItem(this.USER_KEY);if(t)try{return JSON.parse(t)}catch{return null}return null}static \u0275fac=function(e){return new(e||o)(i(u),i(l))};static \u0275prov=a({token:o,factory:o.\u0275fac,providedIn:"root"})};export{g as a};
